<!DOCTYPE html>
<html lang="es">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Juego de Girasoles ğŸŒ»</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fffde7;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #f9a825;
    }
    #game {
      margin-top: 30px;
      display: grid;
      gap: 10px;
      justify-content: center;
    }
    .cell {
      width: 18vw;       /* relativo al ancho de la pantalla */
      height: 18vw;      /* cuadradas */
      font-size: 8vw;    /* el emoji escala proporcional */
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: #fff9c4;
      border-radius: 10px;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
    }
    .cell:hover {
      background: #ffe082;
    }
    #message {
      font-size: 20px;
      margin-top: 20px;
      color: #555;
      white-space: pre-line; /* respeta saltos de lÃ­nea */
      min-height: 120px;
    }
    #bouquet {
      font-size: 100px;
      display: none;
      margin-top: 20px;
      animation: pop 1s ease-in-out forwards;
    }
    @keyframes pop {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    #startScreen {
      margin-top: 50px;
    }
    input, button {
      font-size: 18px;
      padding: 12px 18px;
      border-radius: 8px;
    }

    button {
      background-color: #fdd835;
      color: #333;
    }

    button:hover {
      background-color: #fbc02d;
    }

    button:hover {
      background: #fbc02d;
    }
  </style>
</head>
<body>
  <h1>ğŸŒ» Encuentra el Girasol ğŸŒ»</h1>

  <!-- Pantalla de inicio -->
  <div id="startScreen">
    <p>Ingresa tu nombre para comenzar:</p>
    <input type="text" id="playerName" placeholder="Tu nombre">
    <button onclick="startGame()">Comenzar</button>
  </div>

  <!-- Juego -->
  <div id="game" style="display:none;"></div>
  <div id="message"></div>
  <div id="bouquet">ğŸ’ğŸŒ»ğŸ’ğŸŒ»ğŸ’</div>

  <!-- MÃºsica alegre de fondo -->
  <audio id="celebrationMusic" src="musicgonegone.mp3" preload="auto" loop></audio>
  
  <!-- Fanfarrias/aplausos para el final -->
  <audio id="finalSound" src="https://www.fesliyanstudios.com/play-mp3/387" preload="auto"></audio>

  <script>
    const distractors = ["ğŸƒ","â˜€ï¸","â­","ğŸŒ™","ğŸ‚"];
    let level = 1;
    let maxLevel = 7;
    let interval = null;
    let player = "";

    function startGame() {
      const nameInput = document.getElementById("playerName");
      player = nameInput.value.trim() || "Jugador";
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("game").style.display = "grid";

      // Reproducir mÃºsica alegre de fondo
      const music = document.getElementById("celebrationMusic");
      music.play();

      startLevel(level);
    }

    function startLevel(lvl) {
      const game = document.getElementById("game");
      const message = document.getElementById("message");
      game.innerHTML = "";
      message.textContent = `Nivel ${lvl}`;

      const size = lvl + 1; 
      game.style.gridTemplateColumns = `repeat(${size}, 1fr)`;

      const totalCells = size * size;
      let flowerIndex = Math.floor(Math.random() * totalCells);

      function renderGrid() {
        game.innerHTML = "";
        flowerIndex = Math.floor(Math.random() * totalCells);

        for (let i = 0; i < totalCells; i++) {
          const cell = document.createElement("div");
          cell.className = "cell";

          if (i === flowerIndex) {
            cell.textContent = "ğŸŒ»";
            cell.onclick = () => nextLevel();
          } else {
            cell.textContent = distractors[Math.floor(Math.random() * distractors.length)];
            cell.onclick = () => cell.style.opacity = "0.3";
          }

          game.appendChild(cell);
        }
      }

      renderGrid();

      if (lvl >= 5) {
        let speed = 1000; // 1 segundo
        if (lvl === 6) speed = 750; 
        if (lvl === 7) speed = 800; 
        interval = setInterval(renderGrid, speed);
      }
    }

    function nextLevel() {
      if (interval) {
        clearInterval(interval);
        interval = null;
      }
      if (level < maxLevel) {
        level++;
        startLevel(level);
      } else {
        finishGame();
      }
    }

    function finishGame() {
      const game = document.getElementById("game");
      const message = document.getElementById("message");
      const bouquet = document.getElementById("bouquet");

      game.innerHTML = "";
      bouquet.style.display = "block";

      // Detener mÃºsica alegre de fondo
      const music = document.getElementById("celebrationMusic");
      music.pause();
      music.currentTime = 0;

      // Reproducir fanfarria/aplausos
      const finalSound = document.getElementById("finalSound");
      finalSound.play();

      // Cuando termine la fanfarria, reactivar la mÃºsica alegre
      finalSound.onended = () => {
        music.play();
      };

      // Confeti
      launchConfetti();

      // Texto con efecto mÃ¡quina de escribir
      const fullMessage = `Â¡Felicidades ${player}! Encontraste todos los girasoles ğŸŒ»ğŸ’› 
      
ğŸ’Œ Cada girasol que encontraste representa un pensamiento bonito que tengo hacia ti. 
Este ramo es para recordarte que, aunque no pueda verte seguido, siempre serÃ¡s mi luz y mi alegrÃ­a.
                                    ğŸ’ŒTe Quiero Mucho ${player}ğŸ’Œ`;

      let i = 0;
      message.innerHTML = "";
      function typeWriter() {
        if (i < fullMessage.length) {
          message.innerHTML += fullMessage.charAt(i);
          i++;
          setTimeout(typeWriter, 60); // velocidad (ms por letra)
        }
      }
      typeWriter();
    }

    // Confeti
    function launchConfetti() {
      const duration = 3 * 1000;
      const end = Date.now() + duration;

      (function frame() {
        confetti({
          particleCount: 5,
          angle: 60,
          spread: 55,
          origin: { x: 0 }
        });
        confetti({
          particleCount: 5,
          angle: 120,
          spread: 55,
          origin: { x: 1 }
        });

        if (Date.now() < end) {
          requestAnimationFrame(frame);
        }
      })();
    }
  </script>

  <!-- LibrerÃ­a de confeti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
</body>
</html>


